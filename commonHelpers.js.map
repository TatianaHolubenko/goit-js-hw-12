{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst searchForm = document.querySelector('.picture-search-form');\nconst searchInput = document.querySelector('.picture-search-name');\nconst loaderContainer = document.querySelector('.loader-container');\nconst loadMoreButton = document.querySelector('.load-more-button');\n\nconst API_KEY = '41764451-f0ee5e8d00846e21c9f97a054';\nlet currentPage = 1;\nconst perPage = 40;\n\nfunction showLoader() {\n  loaderContainer.style.display = 'block';\n}\nfunction hideLoader() {\n  loaderContainer.style.display = 'none';\n}\n\nlet requestParams = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: currentPage,\n  per_page: perPage,\n};\n\nasync function searchImages(query, currentPage) {\n  requestParams.q = query;\n  requestParams.page = currentPage;\n\n  const searchParams = new URLSearchParams(requestParams);\n\n  showLoader();\n\n  try {\n    const response = await axios.get(\n      `https://pixabay.com/api/?${searchParams}`\n    );\n\n    hideLoader();\n    const { hits, totalHits } = response.data;\n\n    if (hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      return;\n    }\n\n    const gallery = document.querySelector('.gallery');\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionDelay: 250,\n      captionsData: 'alt',\n      close: true,\n    });\n\n    if (currentPage === 1) {\n      gallery.innerHTML = '';\n    }\n\n    const galleryHtml = hits.reduce(\n      (html, image) =>\n        html +\n        `<a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${image.webformatURL}\"\n                alt=\"${image.tags}\"\n            />\n           <ul class=\"info-list\">\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Likes</p>\n                  <p class=\"info-value\">${image.likes}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Views</p>\n                  <p class=\"info-value\">${image.views}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Comments</p>\n                  <p class=\"info-value\">${image.comments}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Downloads</p>\n                  <p class=\"info-value\">${image.downloads}</p>\n              </li>\n            </ul>\n        </a>`,\n      ''\n    );\n    gallery.insertAdjacentHTML('beforeend', galleryHtml);\n    lightbox.refresh();\n\n    if (currentPage * perPage >= totalHits) {\n      loadMoreButton.style.display = 'none';\n      iziToast.error({\n        title: 'Error',\n        message: error.message,\n        position: 'topRight',\n      });\n    } else {\n      loadMoreButton.style.display = 'block';\n      const scrollImages = document\n        .querySelector('.gallery-link')\n        .getBoundingClientRect().height;\n      window.scrollBy({\n        top: scrollImages * 2,\n        behavior: 'smooth',\n      });\n    }\n  } catch {\n    hideLoader();\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n      position: 'topRight',\n    });\n  }\n}\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n\n  const searchQuery = searchInput.value.trim();\n  currentPage = 1;\n  searchImages(searchQuery);\n  searchForm.reset();\n});\n\nloadMoreButton.addEventListener('click', () => {\n  currentPage += 1;\n  const searchQuery = searchInput.value.trim();\n  searchImages(searchQuery);\n});\n"],"names":["searchForm","searchInput","loaderContainer","loadMoreButton","API_KEY","currentPage","perPage","showLoader","hideLoader","requestParams","searchImages","query","searchParams","response","axios","hits","totalHits","iziToast","gallery","lightbox","SimpleLightbox","galleryHtml","html","image","scrollImages","event","searchQuery"],"mappings":"owBAQA,MAAMA,EAAa,SAAS,cAAc,sBAAsB,EAC1DC,EAAc,SAAS,cAAc,sBAAsB,EAC3DC,EAAkB,SAAS,cAAc,mBAAmB,EAC5DC,EAAiB,SAAS,cAAc,mBAAmB,EAE3DC,EAAU,qCAChB,IAAIC,EAAc,EAClB,MAAMC,EAAU,GAEhB,SAASC,GAAa,CACpBL,EAAgB,MAAM,QAAU,OAClC,CACA,SAASM,GAAa,CACpBN,EAAgB,MAAM,QAAU,MAClC,CAEA,IAAIO,EAAgB,CAClB,IAAKL,EACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUC,CACZ,EAEA,eAAeI,EAAaC,EAAON,EAAa,CAC9CI,EAAc,EAAIE,EAClBF,EAAc,KAAOJ,EAErB,MAAMO,EAAe,IAAI,gBAAgBH,CAAa,EAEtDF,IAEA,GAAI,CACF,MAAMM,EAAW,MAAMC,EAAM,IAC3B,4BAA4BF,GAClC,EAEIJ,IACA,KAAM,CAAE,KAAAO,EAAM,UAAAC,GAAcH,EAAS,KAErC,GAAIE,EAAK,SAAW,EAAG,CACrBE,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6DACT,SAAU,UAClB,CAAO,EACD,MACD,CAED,MAAMC,EAAU,SAAS,cAAc,UAAU,EAE3CC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,IACd,aAAc,MACd,MAAO,EACb,CAAK,EAEGf,IAAgB,IAClBa,EAAQ,UAAY,IAGtB,MAAMG,EAAcN,EAAK,OACvB,CAACO,EAAMC,IACLD,EACA,iCAAiCC,EAAM;AAAA;AAAA;AAAA,uBAGxBA,EAAM;AAAA,uBACNA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,0CAKaA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA;AAAA,0CAINA,EAAM;AAAA;AAAA;AAAA,cAI1C,EACN,EAII,GAHAL,EAAQ,mBAAmB,YAAaG,CAAW,EACnDF,EAAS,QAAO,EAEZd,EAAcC,GAAWU,EAC3Bb,EAAe,MAAM,QAAU,OAC/Bc,EAAS,MAAM,CACb,MAAO,QACP,QAAS,MAAM,QACf,SAAU,UAClB,CAAO,MACI,CACLd,EAAe,MAAM,QAAU,QAC/B,MAAMqB,EAAe,SAClB,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CACd,IAAKA,EAAe,EACpB,SAAU,QAClB,CAAO,CACF,CACL,MAAI,CACAhB,IACAS,EAAS,MAAM,CACb,MAAO,QACP,QAAS,MAAM,QACf,SAAU,UAChB,CAAK,CACF,CACH,CAEAjB,EAAW,iBAAiB,SAAUyB,GAAS,CAC7CA,EAAM,eAAc,EAEpB,MAAMC,EAAczB,EAAY,MAAM,KAAI,EAC1CI,EAAc,EACdK,EAAagB,CAAW,EACxB1B,EAAW,MAAK,CAClB,CAAC,EAEDG,EAAe,iBAAiB,QAAS,IAAM,CAC7CE,GAAe,EACf,MAAMqB,EAAczB,EAAY,MAAM,KAAI,EAC1CS,EAAagB,CAAW,CAC1B,CAAC"}